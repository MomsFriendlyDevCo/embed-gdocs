function f(c){let e={selector:null,url:null,urlOptions:{cache:"default",headers:{Accept:"text/html"}},keepStyle:!0,fixContentTrim:!0,fixWidth:!0,fixTableWidth:!0,fixPadding:!0,fixLinkTargets:!0,fixLinkShorten:!0,fixImageTitleAsLink:!0,onLoad:r=>r,onMount:r=>null,...c},s=(r,i)=>r.setHTML?r.setHTML(i):r.innerHTML=i;if(!e.selector)throw new Error("Selector must be specified");if(!e.url)throw new Error("URL must be specified");let a=typeof e.selector=="string"?document.querySelector(e.selector):e.selector;if(!a)throw new Error(`Cannot find selector "${e.selector} to embed GDoc`);return fetch(e.url,e.urlOptions).then(r=>r.text()).then(r=>e.onLoad(r)).then(r=>{let i=document.createElement("div"),o=[];s(i,r);let l=e.fixContentTrim?i.querySelector(".doc-content"):i;if(e.keepStyle){let t=i.querySelector('style[type="text/css"]');l.prepend(t)}if((e.fixWidth||e.fixPadding)&&l.setAttribute("style",[e.fixWidth&&"max-width: none",e.fixPadding&&"padding: 0 20px"].filter(Boolean).join(`;
`)),e.fixTableWidth&&o.push(`${e.selector} table { max-width: none !important; padding: 1.5rem 0 }`,`${e.selector} table td:last-child { width: auto !important }`),e.fixParaMargins&&o.push(`${e.selector} p { margin-bottom: 1rem }`),(e.fixLinkTargets||e.fixLinkShorten)&&Array.from(l.querySelectorAll("a")).filter(t=>/^https?:\/\//.test(t.getAttribute("href"))).forEach(t=>{e.fixLinkTargets&&t.setAttribute("target","_blank"),e.fixLinkShorten&&t.setAttribute("href",t.getAttribute("href").replace(/^https:\/\/www\.google\.com\/url\?q=(.*?)&.*$/,"$1").replace(/^https:\/\/www\.google\.com\/url\?q=/,"").replace(/^(.+)$/,n=>unescape(n)))}),e.fixImageTitleAsLink&&Array.from(l.querySelectorAll("img[title]")).filter(t=>/^https?:\/\//.test(t.getAttribute("title"))).forEach(t=>{let n=document.createElement("a");n.setAttribute("href",t.getAttribute("title")),e.fixLinkTargets&&n.setAttribute("target","_blank"),t.replaceWith(n),n.replaceChildren(t)}),o.length>0){let t=document.createElement("style");t.setAttribute("type","text/css"),s(t,o.join(`
`)),l.prepend(t)}e.onMount(l),a.replaceChildren(l)})}export{f as default};
//# sourceMappingURL=embed-gdocs.js.map
